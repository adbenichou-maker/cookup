<div class="container-fluid p-3" style="background-color: #F7EEDB;">
  <% if params[:recipe_id].present? %>
    <%# Case 1: Came from Recipe Show Page %>
    <%= link_to recipe_steps_path(params[:recipe_id]), class: "profile-back" do %>
    <i class="fa-solid fa-arrow-left"></i>
<% end %>
  <% else %>
    <%# Case 2: Came from Skills Index/Levels Page %>
    <%= link_to skills_path, class: "profile-back" do %>
    <i class="fa-solid fa-arrow-left"></i>
    <% end %>
  <% end %>
  <header class="text-center mb-4">
    <h1 class="display-5 fw-bold mb-2" style="color: #4A4A4A;">
      <%= @skill.title %>
    </h1>

    <div class="d-inline-flex align-items-center p-2 rounded-pill shadow-sm"
        style="background-color: #F2C94C; color: #4A4A4A;">
      <i class="bi bi-award-fill me-2" style="color: #C9815B;"></i>
      <span class="fw-bold">
        Skill Level: <%= @skill.skill_level.humanize %>
      </span>
    </div>
  </header>

  <div class="row justify-content-center">
    <div class="col-12 col-md-8">

      <%# Skill Video Section %>
      <section class="card shadow-lg mb-4 border-0" style="border-radius: 12px; overflow: hidden;">
        <div class="ratio ratio-16x9">
          <%= video_tag @skill.video,
              controls: true,
              autoplay: false,
              class: "w-100",
              style: "background-color: #4A4A4A;" %>
        </div>
      </section>

      <%# Skill Description Section %>
      <section class="card shadow-sm mb-4 border-start border-4"
              style="border-color: #8BAA7B !important; background-color: rgba(255, 255, 255, 0.7);">
        <div class="card-body">
          <h2 class="h5 fw-bold mb-3" style="color: #C9815B;">
            What You Will Learn
          </h2>
          <p class="card-text lead" style="color: #4A4A4A;">
            <%= @skill.description %>
          </p>
        </div>
      </section>
      <% if user_signed_in? %>
        <div class="d-grid mb-5">
          <% if !current_user.user_skills.exists?(skill_id: @skill.id) %>
            <%= button_to "Mark as Learned ðŸ§‘â€ðŸ³",
                skill_user_skills_path(@skill, recipe_id: params[:recipe_id]),
                method: :post,
                form: { data: { turbo_confirm: "Are you sure you mastered this skill?" } },
                class: "btn btn-lg fw-bold text-white shadow-lg",
                style: "background-color: #8BAA7B; border-color: #8BAA7B;" %>

          <% else %>
            <div class="text-center p-3 mb-3 border border-3 rounded-5 shadow-sm"
              style="border-color: #8BAA7B !important; background-color: rgba(255, 255, 255, 0.7); color: #4A4A4A;">
              <i class="bi bi-check-circle-fill me-2" style="color: #8BAA7B;"></i>
              <span class="fw-bold">You've already mastered this skill âœ…</span>
            </div>

          <% end %>
        </div>
      <% end %>

    </div>
  </div>
</div>
