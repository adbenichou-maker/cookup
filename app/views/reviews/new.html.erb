<div class="container-fluid p-4" style="background-color: #F7EEDB; min-height: 100vh;">
  <%= link_to congratulation_recipe_path(params[:recipe_id]), class: "profile-back" do %>
    <i class="fa-solid fa-arrow-left"></i>
    <% end %>
  <header class="text-center mb-5 pt-3">
    <h1 class="display-5 fw-bold" style="color: #4A4A4A;">
      Reviewing <%= @recipe.title %> üç≤
    </h1>
    <p class="lead" style="color: #C9815B;">
      Share your experience and rate this recipe.
    </p>
  </header>
  <div class="row justify-content-center">
    <div class="col-12 col-md-8 col-lg-6">
      <%= form_with model: [@recipe, @review], local: true, class: "card p-4 rounded-4 shadow-lg" do |f| %>
        <% if @review.errors.any? %>
          <div id="error_explanation" class="alert alert-danger rounded-3 fw-bold">
            <h4 class="alert-heading h6">Please fix the following errors:</h4>
            <ul>
              <% @review.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <div class="mb-3">
          <%= f.label :title, "Review Title", class: "form-label fw-bold" %>
          <%= f.text_field :title, class: "form-control rounded-pill", placeholder: "Quick, tasty, and easy!" %>
        </div>

        <div class="mb-3">
          <%= f.label :comment, "Your Detailed Comments", class: "form-label fw-bold" %>
          <%= f.text_area :comment, rows: 5, class: "form-control rounded-3", placeholder: "The steps were clear and the result was fantastic!" %>
        </div>

        <div class="mb-4 text-center" data-controller="review-stars">
          <label class="form-label fw-bold d-block mb-3">Rate the Recipe</label>

          <div class="review-stars" data-review-stars-target="stars">
            <% (1..5).each do |i| %>
              <span
                class="star"
                data-action="click->review-stars#select mouseover->review-stars#hover mouseout->review-stars#reset"
                data-value="<%= i %>">
                ‚òÜ
              </span>
            <% end %>
          </div>

          <%= f.hidden_field :rate, value: @review.rate || 0, data: { review_stars_target: "input" } %>

          <small class="text-muted d-block mt-2">
            Click a star to set your rating.
          </small>
        </div>

        <%# FIX APPLIED HERE: Added mb-5 (margin-bottom: 3rem) to the d-grid wrapper %>
        <div class="d-grid mt-4 mb-5">
          <%= f.submit "Submit Review ‚≠êÔ∏è",
            class: "btn btn-lg fw-bold text-white rounded-pill shadow-sm",
            style: "background-color: #8BAA7B; border-color: #8BAA7B;" %>
        </div>

      <% end %>
    </div>
  </div>
</div>
