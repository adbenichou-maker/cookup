<% favorite = current_user ? current_user.favorites.find_by(recipe_id: recipe.id) : nil %>

<div id="<%= dom_id(recipe, :favorite_button) %>">
  <% if current_user %>
    <% if favorite %>
      <%= button_to favorite_path(favorite),
          method: :delete,
          class: "favorite-btn saved",
          form: { data: { turbo: true }, class: "favorite-form" } do %>
        âœ”
      <% end %>
    <% else %>
      <%= form_with url: favorites_path,
          method: :post,
          data: { turbo: true },
          html: { class: "favorite-form" } do %>
        <%= hidden_field_tag :recipe_id, recipe.id %>
        <%= submit_tag "+", class: "favorite-btn" %>
      <% end %>
    <% end %>
  <% else %>
    <%= link_to "+", new_user_session_path, class: "favorite-btn" %>
  <% end %>
</div>
