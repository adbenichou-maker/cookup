<div class="ai-form-container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <%= link_to dashboard_path, class: "profile-back" do %>
      <i class="fa-solid fa-arrow-left"></i>
    <% end %>
    <a class="btn btn-secondary btn-sm" href="#" data-bs-toggle="offcanvas" data-bs-target="#chatsOffcanvas" aria-controls="chatsOffcanvas">
      <i class="fa-solid fa-bars me-2"></i>Chats
    </a>
  </div>
  <h1 class="mt-4">What's Cooking?</h1>
  <p class="opacity-75">Tell your AI Chef about the dish you want to create.</p>

  <%= simple_form_for @chat, url: chats_path, method: :post do |f| %>

    <%= f.simple_fields_for :recipe_requirements, @recipe_requirements do |req| %>
      <% meal_types = ['Breakfast', 'Lunch', 'Dinner', 'Dessert'] %>
      <% skill_levels = ['Beginner', 'Intermediate', 'Advanced'] %>

      <div class="space-y-6">

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
          <%= req.input :ingredients,
            label: "Key Ingredients",
            input_html: { class: "form-control input" },
            placeholder: "e.g., chicken, basil, tomatoes" %>
        </div>

        <div class="mb-4">
          <label class="form-label">Your Cooking Skill Level</label>
          <div class="d-flex w-100" aria-label="Skill level selection">
            <% skill_levels.each do |level| %>
              <% level_id = "skill_#{level.downcase}" %>
              <input type="radio"
                    class="btn-check"
                    name="chat[recipe_requirements][skill_level]"
                    id="<%= level_id %>"
                    value="<%= level %>"
                    autocomplete="off"
                    <%= 'checked' if @recipe_requirements[:skill_level] == level %>>
              <label class="btn btn-outline-primary flex-grow-1" for="<%= level_id %>"><%= level %></label>
            <% end %>
          </div>
        <div class="mb-4">
          <label class="form-label">Meal Type</label>
          <div class="d-flex flex-wrap w-100" role="group" aria-label="Meal type selection">
            <% meal_types.each do |type| %>
              <% type_id = "meal_#{type.downcase}" %>
              <input type="radio"
                    class="btn-check"
                    name="chat[recipe_requirements][meal_type]"
                    id="<%= type_id %>"
                    value="<%= type %>"
                    autocomplete="off"
                    <%= 'checked' if @recipe_requirements[:meal_type] == type %>>
              <label class="btn btn-outline-primary w-50 w-md-25" for="<%= type_id %>"><%= type %></label>
            <% end %>
          </div>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
          <%= req.input :meal_prep_time,
            collection: [[10,10],[15,15],[20,20],[30,30],[45,45],["1hr +",60]],
            label: "Preparation Time",
            prompt: "Select preparation time",
            input_html: { class: "form-select input" } %>
        </div>
        <%= req.input :restrictions,
            as: :text,
            label: "Dietary Restrictions or Notes",
            input_html: { rows: 4, class: "form-control input" } %>
      </div>
    <% end %>
    <div class="mt-6 mb-5">
      <%= f.submit 'Generate Recipes!', class: 'btn btn-primary w-100' %>
    </div>
  <% end %>
</div>

<%= render 'shared/offcanvas' if user_signed_in? %>
